---
title: "Segmentation Model"
date: ""
excerpt: "눈의 안쪽 부분을 찍는 안저사진에서 망막병증을 탐지하는 모델"
category: "Career"
tags: ["Python", "NLP", "Machine Learning", "FastAPI", "RAG"]
---

- 기간 : 2024.04 ~ 2024.06 (3개월)
- 역할 : 문제정의, 프로젝트 설계, 구현까지 모든 과정

# 프로젝트 개요

당뇨병성 망막병증은 당뇨병 환자에게 자주 발생하는 합병증으로, 혈관 손상과 새로운 혈관 생성으로 인해 실명까지 유발할 수 있는 심각한 질환입니다. 초기 진단이 매우 중요한 이 병증을 안저사진을 통해 탐지하는 서비스를 개발했습니다.


# 문제해결과정

프로젝트 진행 중 가장 큰 이슈는 데이터 부족이었습니다.

# 초기 데이터 상황
- 오픈 데이터셋 활용: 약 1,500개 이미지
- 레이블 보유율: 전체의 80% 정도
- 데이터 품질 문제: 부적절한 레이블 다수 존재

# 데이터 확보 과정
입사 후 임상팀과 협업하여 데이터 검수 및 추가 확보를 진행했지만, 여전히 제한된 데이터 환경에서 프로젝트를 진행해야 했습니다.


# 모델 선택: U-Net 기반

데이터의 특징상 전체 이미지 중 레이블(마스크)이 포함된 부분이 매우 작은 의료 도메인의 특성상, U-Net 계열 모델이 가장 높은 성능을 보이는 것을 확인했습니다. 실제 연구 결과와 프로젝트 내 비교 실험에서도 U-Net이 최고 성능을 달성했습니다.

### 성능 향상을 위한 핵심 기법들

#### 1. 전처리: CLAHE 적용
명암대비 향상 기법인 CLAHE를 적용하여 데이터의 특징을 더 명확하게 만들었습니다.

![CLAHE 적용 결과](attachment:49718d6e-5aad-4125-be77-fd69e2d4cdfd:image.png)

육안으로도 특징이 더 명확하게 보이며, 실제 성능도 향상되었습니다. 다만 과도한 명암대비 향상은 false positive를 증가시키므로 실험을 통해 적정 수준을 설정했습니다.

#### 2. Contrastive Learning 기반 사전학습
ImageNet 사전학습 가중치가 안저사진과 같은 특수한 의료 영상에는 효과적이지 않다는 것을 실험을 통해 확인했습니다. 대신 회사 내 보유한 대량의 안저사진(레이블 없음)을 활용하여 contrastive learning 기반 사전학습을 진행했습니다.

**결과:** 성능 10-15% 향상 달성

#### 3. Multi-Task Learning
U-Net의 인코더-디코더 구조를 활용하여 segmentation 외에 reconstruction task를 추가로 수행하는 multi-task learning을 적용했습니다.
