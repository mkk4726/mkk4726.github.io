---
title: "Segmentation Model"
date: ""
excerpt: "눈의 안쪽 부분을 찍는 안저사진에서 망막병증을 탐지하는 모델"
category: "Career"
tags: ["Python", "NLP", "Machine Learning", "FastAPI", "RAG"]
---

- 기간 : 2024.04 ~ 2024.06 (3개월)
- 역할 : 문제정의, 프로젝트 설계, 구현까지 모든 과정
- 결과 (성과) : 정확도 99%, 에러율 1% 미만의 안정적인 OCR 파이프라인 구축
- 비즈니스에 주는 영향 : 안정적인 데이터 수집 기반을 구축하여 서비스 개발 및 운영의 안정성 확보

# 당뇨병성 망막병증 탐지 모델

## 프로젝트 개요

당뇨병성 망막병증은 당뇨병 환자에게 자주 발생하는 합병증으로, 혈관 손상과 새로운 혈관 생성으로 인해 실명까지 유발할 수 있는 심각한 질환입니다. 초기 진단이 매우 중요한 이 병증을 안저사진을 통해 탐지하는 서비스를 개발했습니다.

안저사진은 눈의 안쪽(망막 부분)을 촬영하여 혈관 상태를 관찰할 수 있게 해주는 의료 영상입니다.

![안저사진](attachment:c3cc07e1-7393-40cb-a62d-d239f3f5ee27:image.png)

이 프로젝트는 의사들의 진단을 지원하는 목적으로 개발되었으며, 입사 전 부트캠프 기간 중 기업연계 프로젝트로 시작하여 입사 후에도 지속적으로 발전시켰습니다.

**관련 링크:**
- [프로젝트 Github](https://github.com/mkk4726/DR-GeuAl)
- [발표영상 유튜브](https://www.youtube.com/watch?v=ox_jmqZ1V64&t=223s)

## 데이터 현황 및 도전과제

프로젝트 진행 중 가장 큰 이슈는 데이터 부족이었습니다.

### 초기 데이터 상황
- 오픈 데이터셋 활용: 약 1,500개 이미지
- 레이블 보유율: 전체의 80% 정도
- 데이터 품질 문제: 부적절한 레이블 다수 존재

### 데이터 확보 과정
입사 후 임상팀과 협업하여 데이터 검수 및 추가 확보를 진행했지만, 여전히 제한된 데이터 환경에서 프로젝트를 진행해야 했습니다.

## 모델링 전략 및 성능 개선

### 모델 선택: U-Net 기반

데이터의 특징상 전체 이미지 중 레이블(마스크)이 포함된 부분이 매우 작은 의료 도메인의 특성상, U-Net 계열 모델이 가장 높은 성능을 보이는 것을 확인했습니다. 실제 연구 결과와 프로젝트 내 비교 실험에서도 U-Net이 최고 성능을 달성했습니다.

### 성능 향상을 위한 핵심 기법들

#### 1. 전처리: CLAHE 적용
명암대비 향상 기법인 CLAHE를 적용하여 데이터의 특징을 더 명확하게 만들었습니다.

![CLAHE 적용 결과](attachment:49718d6e-5aad-4125-be77-fd69e2d4cdfd:image.png)

육안으로도 특징이 더 명확하게 보이며, 실제 성능도 향상되었습니다. 다만 과도한 명암대비 향상은 false positive를 증가시키므로 실험을 통해 적정 수준을 설정했습니다.

#### 2. Contrastive Learning 기반 사전학습
ImageNet 사전학습 가중치가 안저사진과 같은 특수한 의료 영상에는 효과적이지 않다는 것을 실험을 통해 확인했습니다. 대신 회사 내 보유한 대량의 안저사진(레이블 없음)을 활용하여 contrastive learning 기반 사전학습을 진행했습니다.

**결과:** 성능 10-15% 향상 달성

#### 3. Multi-Task Learning
U-Net의 인코더-디코더 구조를 활용하여 segmentation 외에 reconstruction task를 추가로 수행하는 multi-task learning을 적용했습니다.

## 모델 서빙 및 배포

### 배포 전략
서비스 초기 단계의 특성을 고려하여 빠른 모델 배포가 가능한 방법을 채택했습니다.

### 기술 스택
- **모델 최적화:** TensorRT engine 변환
- **서빙 플랫폼:** Triton Server
- **장점:** 
  - 모델 추론 최적화 용이
  - GPU 자원 관리 자동화
  - 요청/응답 처리 간소화

## 프로젝트 성과

| 항목 | 내용 |
|------|------|
| **프로젝트명** | 당뇨병성 망막병증 병변 탐지 모델링 및 서비스 개발 |
| **기간** | 2024년 4월 ~ 2025년 6월 (3개월) |
| **주요 성과** | • Contrastive Learning 적용으로 일반화 성능 향상<br>• 제한된 데이터에서도 모델 판별력 개선<br>• Multi-Task Learning으로 병변 탐지 성능 최적화<br>• Segmentation 성능: IoU 개선, Dice Score 0.8 달성 |
| **역할** | • 최신 연구 분석 및 모델 설계 적용<br>• 데이터 부족 문제 해결을 위한 기법 적용<br>• 데이터 품질 개선 및 정제<br>• 모델 최적화 및 하이퍼파라미터 튜닝 |
| **기술 스택** | PyTorch, Triton-Server, gRPC, Docker |
