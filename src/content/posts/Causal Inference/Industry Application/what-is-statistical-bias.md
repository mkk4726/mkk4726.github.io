---
title: "통계적인 편향과 이를 제거하기 위한 방법론"
date: "2025-07-09"
excerpt: "실제 데이터에서 통계적 편향을 확인하고 이를 잔차화를 통해 제거하는 과정"
category: "Causal Inference"
tags: ["편향", "통계적", "bias"]
---

# 배경
---

인과추론의 기본적인 개념은 통계적 편향 (Statistical Bias)을 제거하는 것입니다.
인과추론을 더 잘 이해하고 효과를 확인하기 위해서는, 이 통계적 편향을 이해하고 확인하는 과정이 필요하다고 생각합니다.

# 정의
---

> 통계적 편향(Statistical Bias)은 통계 분석 과정에서 발생하는 체계적인 오류로, 측정이나 추정 과정에서 실제 모집단의 모수(parameter)와 표본 통계량 사이에 일관된 차이가 발생하는 현상을 말합니다.

- 체계적(systematic) 오류란?
    - 측정 방법이나 분석 방법에 문제가 있어 발생하는 오류
    - 무작위가 아닌, 일정한 패턴이나 방향성을 가짐
- 체계적 오류 (Systematic Error) vs 무작위 오류 (Random Error)
    - 체계적 오류 (Systematic Error):
        항상 같은 방향으로 발생 (예: 항상 실제값보다 높게 측정)
        - 측정 횟수를 늘려도 줄어들지 않음
        - 측정 도구나 방법의 결함에서 비롯됨
    - 무작위 오류 (Random Error):
        - 방향이 불규칙함 (때로는 높게, 때로는 낮게)
        - 측정 횟수를 늘리면 평균적으로 상쇄됨
        - 우연한 변동에서 비롯됨


제가 이해한 개념은, 랜덤 노이즈가 아닌 구조상의 문제가 있어 결과를 확인하는데 오해를 만드는 것이라고 생각합니다.

예를 들어 보면:

- 구조상 문제: 온라인 설문조사로만 의견을 수집 → 디지털 기기 사용이 어려운 고령층 의견 누락되고 젊은 층의 의견만 반영됨
- 결과의 오해: "젊은 층의 의견이 전체 의견"이라고 잘못 해석할 수 있습니다.


## 통계적 편향의 종류와 설명

### 1. 선택 편향 (Selection Bias)
> 연구 대상을 선택하는 과정에서 발생하는 편향으로, 표본이 모집단을 제대로 대표하지 못할 때 발생합니다.

**예시:**
- 병원 데이터만으로 질병 연구를 할 때 → 중증 환자만 포함되어 질병의 심각성이 과대평가됨
- 자발적 참여자만으로 설문조사 → 특정 관심사를 가진 사람들만 참여하여 결과가 편향됨

제가 앞서 예시를 든 경우가 이에 해당합니다.
한국 남자의 평균 푸쉬업 개수를 측정한다고 할 때, 헬스장에서 푸쉬업 개수를 측정한다면 이는 한국 남자를 대표할 수 있을까요?

### 2. 교란변수 편향 (Confounding Bias)
> 원인변수와 결과변수 모두에 영향을 미치는 제3의 변수(교란변수)를 고려하지 않아 발생하는 편향입니다. **인과추론에서 가장 중요한 편향**입니다.

**예시:**
- 커피 소비와 심장병의 관계 연구에서 흡연을 고려하지 않은 경우
- 교육과 소득의 관계에서 가정 배경을 고려하지 않은 경우

### 3. 정보 편향 (Information Bias)
> 데이터 수집 과정에서 발생하는 편향으로, 측정 오류나 분류 오류로 인해 발생합니다.

**하위 유형:**
- **회상 편향 (Recall Bias)**: 과거 사건을 기억하는 정확도 차이
- **관찰자 편향 (Observer Bias)**: 연구자의 주관적 판단이 개입
- **측정 편향 (Measurement Bias)**: 측정 도구나 방법의 결함

**예시:**
- 질병 환자가 건강한 사람보다 과거 노출을 더 잘 기억하는 경우
- 연구자가 가설을 알고 있어 결과를 주관적으로 해석하는 경우

### 4. 생존 편향 (Survivorship Bias)
> 성공하거나 살아남은 사례에만 집중하고, 실패하거나 탈락한 사례를 고려하지 않아 발생하는 편향입니다.

**예시:**
- 성공한 기업가들만 인터뷰하여 "창업 성공 요인" 분석
- 졸업생만 대상으로 한 대학 교육 효과 연구 (중도 탈락자 제외)

### 5. 발표 편향 (Publication Bias)
> 통계적으로 유의한 결과나 긍정적인 결과만 발표되고, 그렇지 않은 결과는 발표되지 않아 발생하는 편향입니다.

**예시:**
- 약물 효과가 있는 연구만 논문으로 발표되고, 효과가 없는 연구는 발표되지 않음
- 성공적인 정책 사례만 보고되고, 실패한 정책은 보고되지 않음

### 6. 시간 관련 편향 (Time-related Bias)
> 시간의 흐름과 관련하여 발생하는 편향입니다.

**하위 유형:**
- **시대 효과 (Period Effect)**: 특정 시점의 환경적 요인
- **코호트 효과 (Cohort Effect)**: 특정 세대의 공통 경험
- **연령 효과 (Age Effect)**: 나이에 따른 자연스러운 변화

### 7. 탈락 편향 (Attrition Bias)
> 연구 진행 중 참여자가 탈락하여 발생하는 편향입니다.

**예시:**
- 장기 추적 연구에서 건강한 사람들만 계속 참여하고, 아픈 사람들은 탈락
- 온라인 교육 효과 연구에서 학습 능력이 높은 사람들만 끝까지 참여


결과를 해석할 때 이런 편향들은 오해를 만듭니다.
따라서 이러한 편향을 고려하고 결과를 해석해야하며, 이런 편향을 찾고 제거하는 방법이 인과추론의 주된 목적입니다.


# 내가 다루고 있는 데이터에서의 통계적 편향
---

저는 시력교정병원의 의료 데이터를 분석하고 있습니다.

주요 연구 목적은 환자들에게 다양한 수술 방법을 적용했을 때의 결과를 비교하여, 수술의 효과를 검증하는 것입니다.

당연히 환자마다 눈의 상태가 다르기 때문에 동일한 수술을 해도 결과는 달라집니다.
이러한 개인차를 고려하지 않고 수술 효과를 평가하면, 앞서 설명한 편향이 발생하여 잘못된 결론을 내릴 수 있습니다.

수술마다 환자의 분포가 다르고 이 환자들에 대해 결과를 비교하는 건 문제가 있을 수 있다고 생각해볼 수 있습니다.
그리고 이는 혼동 편향 (Confounding Bias)이라고 생각해볼 수 있습니다.

## 왜 Confounding Bias인가?

구조:
- 원인변수: 수술 방법 (A수술 vs B수술)
- 결과변수: 수술 결과 (시력 개선 정도)
- 혼동변수: 환자의 눈 상태 (근시 정도, 각막 두께, 나이 등)

문제점:
1. 눈 상태가 수술 방법 선택에 영향을 미침
- 예: 각막이 얇은 환자는 특정 수술만 가능
- 근시가 심한 환자는 다른 수술 방법 선택
2. 눈 상태가 수술 결과에도 직접 영향을 미침
- 예: 각막이 두꺼운 환자가 일반적으로 결과가 좋음
- 젊은 환자가 회복이 빠름

결과:
눈 상태를 통제하지 않으면, 수술 방법 자체의 효과가 아닌 환자 특성의 차이를 수술 효과로 잘못 해석하게 됩니다.

# 이를 어떻게 보여줄 수 있을까?
---

요즘 가장 많은 고민을 하고 있는 부분입니다.

> 논리적으로 편향이 발생하는 구조이고, 이를 해결하기 위해 인과추론을 도입했다.
> 그래서 결과는? 어느정도 좋아졌는데?

어떤 방법을 도입한 후의 결과를 명확하게 보여줘야 하는데, 이를 어떻게 보여줄 수 있을지에 대한 고민입니다.

제가 보고 있는 데이터에 대한 설명을 추가적으로 하자면 다음과 같습니다.

- 수술방법의 차이 : 렌즈삽입술에서 사용하는 렌즈 크기 [12.1, 12.6, 13.2]
- 환자 눈의 조건 : [나이, ATA(눈의 가로길이), ACD(눈의 세로길이), CLR(수정체의 상태)]


## 수술방법 별로 눈의 조건 분포를 확인하기
---

<small>*처치 : 인과추론에서 연구자가 조작하는 변수(예: 수술 방법, 약물 투여). 처치 그룹과 대조 그룹을 비교하여 효과를 평가합니다.*</small>

> 처치(수술방법, 삽입하는 렌즈크기)별로 환자 눈의 분포가 같은가? 

<figure>
  <img src="/post/what-is-statistical-bias/처치별_Feature_DensityPlot.png" alt="처치별 Feature Density Plot">
  <figcaption>그림 1: 처치별 Feature 분포 비교</figcaption>
</figure>

<figure>
  <img src="/post/what-is-statistical-bias/boxplot_grouped_by_size.png" alt="Boxplot Grouped by Size">
  <figcaption>그림 2: 크기별 그룹화된 박스플롯</figcaption>
</figure>

ata와 clr의 경우 분포의 차이가 명확히 보이고 있습니다.

> 처치별 환자 눈의 분포가 다르다. 따라서 환자 눈의 조건을 통제하지 않고 수술 효과를 평가하면 오해를 만들 수 있다.

즉 ata와 clr은 처치와 결과변수 모두에 영향을 주는 교란변수 (confounding variable)이라고 할 수 있습니다.
그리고 처치별 결과 차이는 이 교란변수에 의해 왜곡될 수 있습니다.


<figure>
  <img src="/post/what-is-statistical-bias/처치별결과비교.png" alt="처치별 결과 비교">
  <figcaption>그림 3: 처치별 결과 분포 비교</figcaption>
</figure>

> 단순히 처치별 분포의 차이를 통해 처치가 결과에 미치는 영향을 판단할 수 없다.

같은 크기의 눈에 3가지 종류의 렌즈를 모두 넣은 결과가 있다면, 이를 통해 렌즈 크기가 결과에 미치는 영향을 판단할 수 있습니다.
하지만 그림1과 2에서 확인한 것처럼 렌즈별로 다른 크기의 눈에 렌즈를 넣어 결과를 얻었기 때문에, 이를 통해서는 렌즈 크기가 결과에 미치는 영향을 판단할 수 없습니다.

처치가 결과에 미치는 영향을 실질적으로 분석하기 위해서는 통계적 편향을 제거할 필요가 있습니다.

# 예측 모델의 한계점
---

예측 모델은 상관관계에 기반해 패턴을 찾습니다.

[인과추론이란?](/posts/Causal%20Inference/what-is-causal-inference)
[상관관계와 인과관계](/posts/Causal%20Inference/correlation-vs-causation)

이때 confounding variable은 인과관계가 아닌 상관관계를 만들 수 있습니다.

ata가 커질수록 렌즈를 더 큰 걸 사용했고, 따라서 결과 (vaulting)가 더 커진 경향이 있습니다.
이때 모델은 ata가 커지면 vaulting이 커진다고 예측할 수 있습니다.

이런 상황에서 예측 모델에 기반해 처치를 결정하는 건 굉장히 위험합니다.

> 처치와 결과변수 간의 인과관계를 모델링할 필요가 있고, 이를 통해 처치를 결정할 때 신뢰할 수 있는 결과를 얻을 수 있습니다.

# 인과추론으로 이를 해결하는 방법
---

> 교란변수들을 제거하고 처치와 결과변수 간의 인과관계를 모델링해야 합니다.

즉 처치(T)와 결과(Y)에 모두 영향을 미치는 변수를 $X$라고 했을 때, 
- $X$가 $Y$에 미치는 영향을 제거하고
- $X$가 $T$에 미치는 영향을 제거하고

$Y$와 $T$ 간의 인과관계를 모델링해야 합니다.


교란변수를 제거하는 방법은 여러가지가 있지만 그 중에 하나가 잔차화 방법입니다.
[FWL 정리](/posts/Causal%20Inference/2025-07-02-what-is-fwl) 에서 설명한 것처럼 잔차화 방법을 통해 교란변수를 통제할 수 있습니다.

잔차화를 하게 되면 다음과 같은 결과를 얻을 수 있습니다.


<figure>
  <img src="/post/what-is-statistical-bias/사이즈별잔차분포.png" alt="결과에서 교란변수에 대한 영향 제거후 분포">
  <figcaption>그림 4: 잔차화를 통해 교란변수에 대한 영향을 제거한 결과 분포</figcaption>
</figure>


그림3과 비교하면, 처치(렌즈 크기)를 제외한 나머지 교란변수들의 영향을 제거한 결과를 확인할 수 있습니다.
그림4를 통해 렌즈 크기가 결과에 미치는 영향을 확인할 수 있습니다.

잔차화가 잘되었는지는 잔차가 정규분포 형태를 띄는지와 잔차가 교란변수와 독립인지를 확인하면 됩니다.

정규분포 형태를 띄고 있다는 부분은 그림4를 통해 확인할 수 있고,
교란변수와 독립인지는 교란변수로 잔차를 예측하는 모델을 만들어 확인할 수 있습니다.

<figure>
  <img src="/post/what-is-statistical-bias/조건부독립성검사.png" alt="교란변수로 잔차를 예측하는 모델 결과">
  <figcaption>그림 5: 교란변수로 잔차를 예측하는 모델 결과</figcaption>
</figure>

모델이 잔차를 전혀 예측하지 못하는 것을 통해 더 이상 X에 대한 정보가 Y에는 포함되어있지 않다고 생각해볼 수 있습니다.


이 결과를 좀 더 직관적을 해석해보면

<figure>
  <img src="/post/what-is-statistical-bias/같은렌즈크기_같은결과_다른눈.png" alt="같은렌즈크기_같은결과_다른눈">
  <figcaption>그림 6: 같은 렌즈 크기에 같은 결과를 얻었지만 다른 눈을 가진 경우</figcaption>
</figure>



같은 결과를 얻었고 같은 사이즈를 사용했기 때문에, 눈이 결과에 미치는 영향을 고려하지 않으면 렌즈 크기의 영향을 제대로 판단할 수 없습니다.

> 직관적으로 너무나도 당연한 말이지만, 앞서 설명드린 것처럼 이러한 통계적인 편향들을 제거하지 않고 결과를 분석하게 되면 잘못된 결과를 도출할 수 있습니다.


잔차화하는 코드는 [잔차화 코드](/posts/Causal%20Inference/residualization-fwl-theorem-test) 확인해볼 수 있습니다.


# 정리

- 처치 (수술방법, 렌즈크기) 별로 환자의 눈의 분포가 다르다는 것을 확인할 수 있었습니다.
- 수술을 받은 환자의 눈의 분포가 다르기 때문에 수술 결과를 비교하는 것은 문제가 있습니다.
- 정확히 수술 결과를 비교하기 위해서는 결과에서 교란변수의 영향 (통계적 편향) 을 제거한 후 비교해야 합니다.




