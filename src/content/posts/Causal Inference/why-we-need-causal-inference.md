---
title: "인과추론이 필요한 이유"
date: "2025-07-10"
excerpt: "인과추론을 왜 사용해야하는지 설명하고 이를 도입하기 위해 설득하는 글"
category: "Causal Inference"
tags: ["ICL-Lenze-sizing"]
---


# 글 내용 스케치

인과추론에 대한 소개:
인과추론이란 각 요인의 실질적인 영향도를 분석하여 사용자에게 미치는 영향을 직접적으로 추론하는 방법론
렌즈 사이징 문제에서는 렌즈의 크기를 선택했을 때 이것이 결과에 어떤 영향을 주는지를 직접적으로 모델을 통해 추정할 수 있다.

기존연구의 한계점:
기존 연구는 "예측 모델"에 기반하여 이를 구현하려고 했다.
하지만 예측 모델로는 이것이 불가능하다.
1. 상관관계에 기반한 예측 모델의 한계
2. 데이터 안에 존재하는 통계적인 편향성
3. 측정되지 않은 데이터 (반사실, Counterfactual)에 대한 평가를 고려하고 있지 않음

예상결과:
인과추론을 통해 통계적 편향을 제거하고 반사실에 대한 평가지표를 통해 신뢰도가 확보된 모델 개발 가능


# 배경 (Abstract)
---
> 인과추론에 대한 소개와 왜 필요한지 이야기

인과추론이란 의학, 마케팅, 교육 등에서 자주 사용되는 방법론으로 정책 및 비즈니스에 수반된 수많은 의사결정들의 원인과 결과를 분석하는 방법이다.

예를 들어 정밀의학에서는 환자별 처치 효과를 추정하여 처치 선택을 결정하고, 교육에서는 학생별 처치 효과를 추정하여 교육 방법을 결정하고, 온라인 마케팅에서는 사용자별 처치 효과를 추정하여 맞춤형 광고를 제공하고, 오프라인 정책 평가에서는 지역별 처치 효과를 추정하여 정책을 결정할 수 있다.

여기서 처치란 인과추론에서 연구자가 조작하는 변수(예: 수술 방법, 약물 투여)를 의미한다.

렌즈 사이징 문제에서는 인과추론 방법론을 통해 렌즈의 크기를 선택했을 때 이것이 결과에 어떤 영향을 주는지, 즉 인과관계를 직접적으로 모델을 통해 추정할 수 있다.

기존의 렌즈 사이징 모델 연구는 "예측 모델"을 고도화하는 방향으로 진행되었다.
하지만 예측 모델로는 인과관계를 추론할 수 없다.

기존 연구는 다음과 같은 한계점을 가지고 있다.
1. 상관관계에 기반해 패턴을 찾는 예측 모델의 한계
2. 데이터 안에 존재하는 통계적인 편향성
3. 측정되지 않은 데이터 (반사실, Counterfactual)에 대한 평가를 고려하고 있지 않음

이러한 한계점을 극복하기 위해 인과추론을 도입했고 다음과 같은 효과를 기대한다.
1. 통계적 편향을 제거하고 인과관계를 직접적으로 추론
2. 측정되지 않은 데이터에 대한 평가를 고려하여 모델의 신뢰도를 확보
3. "개인화"된 처치 효과 (Heterogeneous Treatment Effects)를 추정하여 개인화된 처치 선택 가능


# 기존 연구의 한계점 분석 (Introduction)
---

렌즈 사이징을 위한 기존의 연구들은 예측 모델을 고도화하는 방향으로 진행되었다.
예측 모델이 가지는 한계점은 무엇인지, 이를 기반으로 선택을 할 때의 위험성에 대해 정리한다.

> 1. 상관관계에 기반하여 패턴을 찾는 예측 모델의 한계

상관관계와 인과관계는 다르다. 상관관계란, 두 변수 사이에 일정한 패턴이나 동반 변동이 존재함을 의미하며, 한 변수가 커질 때 다른 변수가 일정하게 커지거나(양의 상관), 작아지는(음의 상관) 경향을 보이는 통계적 관계를 말한다. 반면 인과관계란, 한 변수가 변할 때 다른 변수가 그 변화에 의해 직접적·체계적으로 영향을 받아 변화하는 관계를 의미한다.

예측 모델은 주어진 데이터에서 변수 간의 동시 변동 패턴, 즉 상관관계를 학습하여 결과를 예측한다. 하지만 이 모델의 예측결과는 인과관계를 보장하지 못한다.

예를 들어 숙박 가격과 매출이 주어진 데이터에서 가격이 높을수록 매출이 높아 보인다면, 모델은 "가격이 오르면 매출이 오른다"고 예측할 것이다. 하지만 이 패턴 뒤에는 "성수기/비수기 여부"라는 숨겨진 외부 요인이 있을 수 있다. 가격이 비수기에 낮아지고 성수기에 올라가는 동시에 매출도 함께 변했다면, 실제로는 계절성이 매출을 결정짓는 실제 원인인데, 단순 예측 모델은 이를 구분하지 못한다. 따라서 상관관계에 기반한 예측 결과를 인과관계로 오해하면 "매출을 올리려면 가격을 올려야 한다"는 잘못된 결론에 이를 수 있고, 실제 효과가 있는 개입(예: 비수기 프로모션) 대신 부적절한 가격 정책을 선택하게 만든다.

예측 모델의 예측 성능은 선택에 대한 근거가 되지 못한다.
그리고 단순히 예측 성능 지표만으로는 선택에 대한 결과를 보장하지 못한다.

> 2. 데이터 안에 존재하는 통계적 편향성

렌즈 사이징 데이터를 분석할 때 가장 큰 문제는 렌즈 크기별로 환자의 분포가 다르다는 점이다.
이는 의사가 환자의 눈 크기, 나이, 각막 두께 등을 고려하여 적절한 렌즈 크기를 선택하기 때문이다. 

<figure>
  <img src="/post/what-is-statistical-bias/처치별_Feature_DensityPlot.png" alt="처치별 Feature Density Plot">
  <figcaption>그림 1: 처치별 Feature 분포 비교</figcaption>
</figure>

문제는 이렇게 환자 그룹이 다른 상태에서 렌즈 효과를 비교하는 것이다. 
렌즈 크기별로 환자 특성이 다르기 때문에, 단순히 결과만 비교해서는 렌즈 자체의 효과를 알 수 없다.
환자의 개별 특성(눈 크기, 나이, 각막 두께 등)을 동일하게 맞춘 상태에서 렌즈 효과를 비교해야 한다. 이것이 바로 통계적 편향을 제거하는 과정이다.

하지만 한명의 환자가 여러 렌즈 크기로 여러 번의 수술을 받지 않기 때문에 이는 현실적으로 불가능하다.
인과추론을 통해 이를 보완할 수 있다.

또한 처치별로 데이터의 분포가 다를 때 예측 모델은 잘못된 상관관계 패턴을 학습할 수 있다. 예를 들어, 12.1mm 렌즈 데이터로 학습된 모델을 13.2mm 렌즈 환자에게 적용하면 문제가 발생한다. 12.1mm 렌즈는 주로 눈이 작은 환자들이 사용했는데, 13.2mm 렌즈는 눈이 큰 환자들이 사용한다. 이렇게 입력 데이터의 분포가 다르기 때문에 모델의 성능을 보장할 수 없고, 잘못된 패턴을 학습했을 가능성이 높다.

결과적으로 예측 모델은 각 처치 그룹별로 다른 환자 특성을 가진 데이터에서 학습되었기 때문에, 특정 처치의 실제 효과가 아닌 그 처치를 받은 환자들의 특성을 반영한 패턴을 학습하게 된다. 

> 3. 측정되지 않은 데이터 (반사실, Counterfactual)에 대한 평가를 고려하고 있지 않음

기존 연구들은 예측 모델을 고도화하는 방향으로 진행되었으며, 예측 성능지표를 통해 모델의 신뢰도를 보장하고 있다.
하지만 최적의 렌즈를 추천하기 위해서는 수술받은 렌즈 외에 다른 렌즈 크기에 대한 결과도 예측해야 한다.
예측 모델의 가장 큰 한계는 실제로 일어나지 않은 상황에 대한 평가가 불가능하다는 점이다.

예를 들어, 환자 A가 12.6mm 렌즈로 수술을 받고 좋은 결과를 얻었다고 가정한다. 이때 정말 알고 싶은 것은 "만약 이 환자가 13.2mm 렌즈로 수술을 받았다면 어떤 결과가 나왔을까?"이다. 하지만 이 환자는 이미 12.6mm 렌즈로 수술을 받았기 때문에, 13.2mm 렌즈의 결과는 영원히 알 수 없다.

이렇게 실제로는 관찰되지 않은 가상의 상황을 **반사실(Counterfactual)**이라고 한다. 
기존 예측 모델들은 관찰된 데이터만으로 학습하기 때문에, 이런 반사실적 상황에 대한 추정이 불가능하다. 결과적으로 "어떤 렌즈가 이 환자에게 최적인가?"라는 핵심 질문에 답할 수 없다.

인과추론은 이런 반사실적 상황을 통계적으로 추정할 수 있는 방법론을 제공하며, 이에 대한 평가지표도 함께 고려해 신뢰도를 확보한다.


# 인과추론을 통해 이를 해결하는 방법 (Method & Result)
---

인과추론 방법론을 통해 통계적 편향을 제거하고 렌즈의 인과적인 효과를 추정할 수 있다.

<figure>
  <img src="/post/what-is-statistical-bias/처치별결과비교.png" alt="처치별 결과 비교">
  <figcaption>그림 2: 처치별 결과 분포 비교</figcaption>
</figure>

처치별 결과(vaulting, 렌즈 후면과 수정체 전면까지의 거리)를 살펴보면 처치간에 분포차이가 분명히 보인다.
하지만 이 분포 차이를 통해 렌즈 크기가 결과에 영향을 미치는 정도를 판단할 수 없다.
왜냐하면 처치별로 환자의 눈의 분포가 분명히 다르기 때문이다.
즉 렌즈의 크기 뿐만 아니라 환자의 눈의 조건이 결과에 영향을 미치기 때문이다.

통계적 편향을 제거하기 위해 환자의 눈의 조건을 통제하고 렌즈 크기별로 결과를 비교해야 한다.
하지만 앞서 언급한 것처럼, 한명의 환자가 여러 렌즈 크기로 여러 번의 수술을 받지 않기 때문에 이는 현실적으로 불가능하다.

따라서 잔차화 방법을 통해 환자의 눈의 조건을 통제하고 렌즈 크기별로 결과를 비교할 수 있다.

<figure>
  <img src="/post/what-is-statistical-bias/사이즈별잔차분포.png" alt="결과에서 교란변수에 대한 영향 제거후 분포">
  <figcaption>그림 3: 잔차화를 통해 통계적 편향을 제거한 결과 분포</figcaption>
</figure>

그림 2에서 렌즈 사이즈를 제외한 나머지 변수의 영향을 제거한 결과이다.
이 결과를 통해 실질적인 렌즈 사이즈가 결과에 미치는 영향을 추정할 수 있게 된다.
왜냐하면 렌즈 사이즈별로 달랐던 환자 눈의 분포 차이를 제거하였기 때문이다.

# 이어서 진행하고 있는 연구, 기대되는 결과 (Conclusion)
---

예측 모델을 고도화하는 기존 연구는 분명한 한계점을 가진다.
처치와 결과 사이의 인과관계를 추론하고 있지 않고, 따라서 선택에 대한 결과를 보장하지 못한다.

따라서 이를 해결하기 위해 인과추론 방법론을 도입하여 기존의 한계를 극복하고 결과의 신뢰도를 보장하는 모델을 개발하고자 한다.
인과추론 모델을 통해 기대되는 결과는 다음과 같다.

> 1. 통계적 편향을 제거하고 인과관계를 직접적으로 추론

인과추론 모델을 통해 통계적 편향을 제거하고 인과관계를 직접적으로 추론할 수 있다.
이를 통해 렌즈 크기가 결과에 미치는 영향을 추정할 수 있다.

> 2. 측정되지 않은 데이터에 대한 평가를 고려하여 모델의 신뢰도를 확보

인과추론 모델을 통해 측정되지 않은 데이터에 대한 평가를 고려하여 모델의 신뢰도를 확보할 수 있다.
기존 연구들이 고려하지 않는 측정되지 않은 데이터에 대한 평가를 고려하여 모델의 신뢰도를 확보할 수 있다.

> 3. "개인화"된 처치 효과 (Heterogeneous Treatment Effects)를 추정하여 개인화된 처치 선택 가능

인과추론 모델을 통해 "개인화"된 처치 효과를 추정하여 개인화된 처치 선택이 가능하다.
개인별로 렌즈 크기가 미치는 영향이 다르므로, 이를 추정하여 사람별로 개인화된 처치 선택이 가능하다.
그리고 이를 통해 최적화된 렌즈 크기를 제안할 수 있다.
