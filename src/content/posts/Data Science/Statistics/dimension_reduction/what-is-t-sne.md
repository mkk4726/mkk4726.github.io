---
title: t-SNE 에 대해 정리"
date: "2025-09-11"
excerpt: "T-SNE에 대해 이해해보기"
category: "Data Science"
tags: ["statistics"]
---

T-distributed Stochastic Neighbor Embedding

고차원의 데이터를 2차원이나 3차원으로 축소해 시각화하기 위해 사용하는 방법론.

비슷한 데이터 포인트는 가깝게, 다른 데이터 포인트는 멀게 배치하는 것

1. 고차원 공간에서 각 데이터 포인트 쌍의 조건부 확률을 계산해. 이 확률은 한 점이 다른 점을 이웃으로 선택할 확률이라고 생각하면 돼.
2. 저차원 공간에서도 비슷한 확률 분포를 만들고, 두 분포 간의 차이(KL 발산)를 최소화하는 방향으로 저차원 데이터 포인트들을 배치해.

비선형적이다.

## PCA vs t-SNE

<figure>
<img src="/post/DataScience/pca-vs-t-sne.png" alt="PCA vs t-SNE" width="100%"/>
<figcaption>그림1. PCA vs t-SNE</figcaption>
</figure>

차이를 이해하고 있어야 언제, 어떤 걸 사용할지 결정할 수 있다.

PCA는 데이터의 분산을 최대한 유지하는 축을 찾고, 이를 이용해 새로운 축을 만드는 개념.
선형적이고, 해석이 쉬움.

t-SNE는 고차원에서의 분포 간의 차이를 최대한 유지하면서 차원을 줄이는 개념.
비선형적이고 해석이 주관적(?)임.

## t-SNE 이론적 내용

### 핵심 아이디어

t-SNE는 고차원 공간에서의 데이터 포인트 간의 유사성을 저차원 공간에서도 유지하려고 합니다. 이를 위해 **확률적 접근**을 사용하여 각 점이 다른 점을 이웃으로 선택할 확률을 계산합니다.

### 수학적 정의

#### 1. 고차원 공간에서의 유사성

고차원 공간에서 두 점 $x_i$와 $x_j$ 사이의 조건부 확률을 다음과 같이 정의합니다:

$$
p_{j|i} = \frac{\exp(-||x_i - x_j||^2 / 2\sigma_i^2)}{\sum_{k \neq i} \exp(-||x_i - x_k||^2 / 2\sigma_i^2)}
$$

그리고 대칭성을 위해:

$$
p_{ij} = \frac{p_{j|i} + p_{i|j}}{2n}
$$

여기서:
- $\sigma_i$: 각 점 $x_i$에 대한 perplexity에 의해 결정되는 가우시안 분포의 표준편차
- $n$: 데이터 포인트의 개수

#### 2. 저차원 공간에서의 유사성

저차원 공간에서는 **t-분포**를 사용합니다:

$$
q_{ij} = \frac{(1 + ||y_i - y_j||^2)^{-1}}{\sum_{k \neq l} (1 + ||y_k - y_l||^2)^{-1}}
$$

여기서 $y_i$는 저차원 공간에서의 점입니다.

#### 3. 목적 함수

t-SNE는 두 분포 $P$와 $Q$ 사이의 **Kullback-Leibler divergence**를 최소화합니다:

$$
C = \sum_i KL(P_i || Q_i) = \sum_i \sum_j p_{ij} \log \frac{p_{ij}}{q_{ij}}
$$

### 알고리즘 과정

1. **고차원 공간에서 유사성 계산**: 각 점에 대해 perplexity를 설정하고 $p_{ij}$ 계산
2. **저차원 공간 초기화**: 랜덤하게 저차원 점들을 초기화
3. **경사 하강법으로 최적화**: KL divergence를 최소화하도록 저차원 점들을 업데이트

### t-분포를 사용하는 이유

고차원에서는 가우시안 분포를, 저차원에서는 t-분포를 사용하는 이유:

1. **Crowding Problem 해결**: t-분포는 꼬리가 더 두꺼워서 중간 거리의 점들 사이에 더 많은 공간을 제공
2. **지역적 구조 보존**: 가까운 점들은 더 가깝게, 먼 점들은 더 멀게 배치

### 주요 특징

**장점:**
- 복잡한 비선형 구조를 잘 보존
- 시각화에 매우 효과적
- 클러스터링 패턴을 명확하게 보여줌

**단점:**
- 계산 비용이 높음 (O(n²))
- 결과가 재현 가능하지 않음 (랜덤 초기화)
- 전역적 구조보다 지역적 구조에 특화
- perplexity 하이퍼파라미터에 민감

### 언제 사용할까?

- **t-SNE 사용**: 데이터 시각화, 클러스터링 패턴 탐색, 복잡한 비선형 구조 분석
- **PCA 사용**: 차원 축소, 노이즈 제거, 빠른 계산이 필요한 경우

