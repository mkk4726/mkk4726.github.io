---
title: "외삽 문제에서 DS가 할 수 있는 방법들"
date: "2025-09-05"
excerpt: "외삽 문제 상황에 어떻게 대처할 수 있을까?"
category: "Causal Inference"
tags: ["extrapolation"]
---

ML(AI) 모델들은 학습된 분포에 과적합되기 쉽고, robustness가 보장되기 어렵습니다. 
즉 입력되는 데이터 분포가 바뀌면 (domain shift) 성능을 보장할 수 없습니다.
이를 해결하기 위해 domain adaptation과 같은 연구들이 진행되고 있습니다.

학습된 데이터 분포 밖의 영역을 예측하는 문제인, 외삽 문제 (extrapolation)에도 마찬가지로 취약합니다.
하지만 서비스를 구성하다보면 외삽을 해야하는 경우가 있습니다.

외삽을 해야만할때 모델을 만드는 사람은 어떻게 대응을 할 수 있는지, 현재 서비스에서는 어떻게 적용하려고 하는지 글로 정리했습니다.

# 외삽을 해야하는 문제 상황

시력교정을 위한 렌즈 삽입 수술에 사용되는, 렌즈 추천 서비스를 구성하고 있습니다.
고객에게 적절한 "크기"의 사이즈를 선택하도록 도와주는 문제입니다.

이를 위해 렌즈 크기 별로 결과를 예측해 제공하고, 이를 통해 의사 (surgeon)가 적절한 크기를 선택하도록 돕습니다.

여기서 문제 상황은 현재 사용하고 있는 렌즈 크기가 10, 30, 50 이 있을 때, 회사에서 그 중간 크기인 20, 40인 렌즈 크기를 개발해 판매를 하려고 하는 상황입니다.
이때 데이터에 없는 20, 40에 예측값을 제공해줘야 합니다.  
( 크기에 대한 관계가 비선형적이고, 새로운 제품이기 때문에 내삽으로 보기엔 어려움 )

# 해결방안에 대한 생각 간단히 정리

<figure>
    <img src="/post/Causal_Inference/extrapolation_idea_sketch.png" alt="extrapolation_idea_sketch" width="100%"/>
    <figcaption>그림1. 아이디어 스케치</figcaption>
</figure>

외삽에 대응하는 방법은 크게 4가지가 있습니다.
1. **Uncertainty Quantification (불확실성 정량화)**
- 모델이 예측할 때 얼마나 확신하는지, 얼마나 불확실한지를 수치로 나타내는 방법
- 예: "20 크기 렌즈의 성공률은 70% ± 15%"처럼 신뢰구간을 제공
- 의사가 예측의 신뢰도를 판단할 수 있게 도움

2. **Inductive Bias (귀납적 편향)**
- 데이터의 구조나 특성을 반영하도록 모델을 설계하는 방법
- 예: 렌즈 크기와 성공률이 비선형 관계라면, 비선형 모델을 사용
- 도메인 지식을 모델 구조에 반영

3. **Domain Adaptation, Transfer Learning**
- 다른 도메인의 데이터나 지식을 활용하는 방법
- 예: 다른 의료기기 데이터나 다른 병원의 렌즈 데이터를 활용
- 적은 데이터로도 더 나은 성능을 얻을 수 있음

4. **Counterfactual Reasoning, Causal Inference**
- "만약 이 환자에게 20 크기 렌즈를 사용했다면?" 같은 가정적 추론
- 단순한 상관관계가 아닌 **인과관계**를 파악
- 새로운 크기의 효과를 더 정확히 예측할 수 있음


2가지 순서로 연구를 진행하고, 논문을 작성 중입니다.
첫번째로 작성 중인 내용은 신뢰할 수 있는 범위 (외삽의 범위, 양수성이 보장되는 범위)를 판단하고 이에 따라 불확실성을 정량화해서 표현하는 방법에 대한 주제입니다.
기존의 연구들은 모두 예측 지표만을 고도화하는 방향으로만 진행되어 왔는데, 이에 대한 한계점을 지적하며 해결방안을 제시하는 방향입니다.

두번쨰로 작성할 부분은 인과추론 모델입니다.
외삽 문제에서 가장 좋은 방법은 모델 자체가 robustness를 가지는 것으로, 데이터 분포에서 인과적인 패턴을 학습하는 것입니다.
이를 위해 R-learner와 같은 모델을 사용합니다.

다만 여기서 가장 어려운 점은 "평가"를 어떻게 할 것이냐에 대한 부분인데, 이를 위해서 2가지 방법을 생각 중입니다.

1. 시뮬레이션 데이터 생성 
casual effect + noise (ex: confounding bias)  를 가지는 데이터를 만들고, 이때 인과추론 모델은 실제로 인과패턴을 찾아서 학습하는지를 확인하는 것입니다.

2. 데이터 안에서 CATE 평가
가지고 있는 데이터에서 간접적으로 모델의 성능을 평가하는 방법입니다.


# 정리

외삽 문제를 다뤄야하는 상황에서 합리적인 모델을 만들기 위해 노력하고 있습니다.
( 그냥 학습한 예측 모델로 결과를 뽑지 않고 )

그래서 이런 연구가 회사의 상품 혹은 서비스를 더 잘 팔리게 하는지? 에 대한 생각을 하게 됩니다.
이 부분은 추측이긴 하지만, 논문을 통해 모델의 신뢰성을 보여준다는 측면에서 매력을 가지지 않을까? 에 대한 생각과 외삽에서 발생하는 문제들을 보완함으로써 사용하면서 신뢰가져갈 수 있지 않을까? 라는 생각을 해봅니다.